## 📦 파일과 `multipart/form-data`: 텍스트 너머의 데이터를 보내는 법

우리가 서버와 주고받는 모든 요청(Request)과 응답(Response)에는 일종의 '내용물 표시' 라벨이 붙어있습니다. 바로 **`Content-Type`** 헤더입니다. 이 헤더는 본문(body)에 담긴 데이터가 어떤 형식인지를 알려주는 역할을 합니다.

지금까지 우리는 `Content-Type: application/json`을 사용해 텍스트 기반의 JSON 데이터를 주고받았습니다. 하지만 프로필 사진을 올리거나 과제 파일을 첨부하는 것처럼, 세상의 모든 데이터가 텍스트인 것은 아니죠. 그렇다면 파일과 같은 바이너리(binary) 데이터는 어떻게 전송할까요?

> 참고1. 바이너리(Binary)가 정확히 뭔가요? 💻
> 컴퓨터가 정보를 이해하고 저장하는 가장 기본적인 방법으로, 세상의 모든 정보를 **오직 0과 1, 두 개의 숫자 조합으로만 표현**하는 것을 말합니다.

> 참고2. 바이너리 데이터에는 뭐가 있나요? 📁
> 간단히 말해, 메모장 같은 일반 텍스트 편집기로 열었을 때 **사람이 바로 읽을 수 없는 모든 파일**이 바이너리 데이터에 해당합니다.

---

### 파일을 전송하는 두 가지 방법

#### 1. 파일을 텍스트로 암호화(Encoding)하기

파일을 Base64와 같은 방식으로 텍스트로 변환한 뒤, JSON 데이터에 포함시켜 보내는 방법입니다.

- **단점**: 이 과정에서 데이터의 용량이 약 30% 이상 커집니다. 작은 아이콘 정도는 괜찮겠지만, 고화질 사진이나 동영상 같은 큰 파일을 보내기에는 매우 비효율적입니다.

> 참고. Base64가 뭔가요? 🤔
> **Base64**는 이미지나 동영상 같은 **바이너리 데이터를 안전하게 전송하기 위해, 모든 사람이 읽을 수 있는 텍스트(ASCII) 문자로 바꾸는 '인코딩' 방식** 중 하나입니다.

#### 2. `multipart/form-data` 사용하기 (표준 방식)

이것이 바로 파일을 전송하는 표준 방식입니다. `multipart/form-data`는 이름 그대로 **'여러 부분(multi-part)으로 나뉜 폼 데이터'** 를 의미합니다.

> **비유로 이해하기: 이삿짐 박스 📦**
>
> HTTP 요청을 하나의 '이삿짐 박스'라고 상상해 보세요.
>
> - **`application/x-www-form-urlencoded`**: "이 박스에는 **책**만 들어있습니다." 라고 라벨을 붙인 것과 같습니다. 텍스트 데이터만 보낼 수 있는 단순한 방식이죠. (주로 HTML 폼의 기본값입니다.)
>
> - **`multipart/form-data`**: "이 박스에는 **여러 종류의 물건**이 들어있습니다." 라고 라벨을 붙인 것과 같습니다. 박스 안에는 칸막이(`boundary`)로 공간이 나뉘어 있고, 각 공간에는 '책'(`text/plain`), '사진 앨범'(`image/jpeg`), '옷'(`application/octet-stream`) 등 각기 다른 종류의 물건이 원래 모습 그대로 담겨 있습니다.

하나의 폼(form) 안에서 사용자의 이름(`text/plain`)과 프로필 사진(`image/jpeg`)을 함께 전송해야 할 때, 이 `multipart/form-data` 방식이 사용됩니다. 이 방식은 파일을 텍스트로 변환하는 비효율적인 과정 없이, 원본 데이터 그대로 전송하기 때문에 파일 업로드에 가장 적합합니다.

---

### `multipart/form-data`는 누가 만들까?

`multipart/form-data`의 실제 구조는 칸막이 역할을 하는 경계 문자열(boundary) 등으로 인해 꽤 복잡합니다. 다행히 개발자가 이 구조를 직접 만들 필요는 없습니다.

웹 페이지의 `<form>` 태그에 `enctype="multipart/form-data"` 속성을 추가하기만 하면, **브라우저가 알아서** 텍스트와 파일을 예쁘게 포장해서 서버로 전송해 줍니다. 서버 개발자는 `multer`와 같은 미들웨어를 사용해 이 박스를 받아 편리하게 내용물을 꺼내기만 하면 됩니다.

> **더 알아보기:** > `multipart/form-data`의 더 자세한 구조가 궁금하다면 아래 MDN 문서를 참고해 보세요.
>
> - [MIME 타입 가이드 (MDN)](https://developer.mozilla.org/ko/docs/Web/HTTP/Guides/MIME_types#multipartform-data)
