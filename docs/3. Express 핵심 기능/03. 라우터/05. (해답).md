## 내가 작성한 답안

```js
// /node03-express-core-features
// /src/app.js
import express from 'express';

const app = express();
const PORT = 3000;

// Product
const productRouter = express.Router();

productRouter.use((req, res, next) => {
  console.log('여기는 Product Router 입니다.');
  next();
});

productRouter
  .route('/')
  .get((req, res, next) => {
    res.json({ message: '상품 목록 보기' });
  })
  .post((req, res, next) => {
    res.json({ message: '상품 추가하기' });
  });
productRouter
  .route('/:id')
  .patch((req, res, next) => {
    res.json({ message: '상품 수정하기' });
  })
  .delete((req, res, next) => {
    res.json({ message: '상품 삭제하기' });
  });

app.use('/products', productRouter);

// User
const userRouter = express.Router();

userRouter.use((req, res, next) => {
  //console.log(req.headers); => 먼저 실행해보기
  const auth = req.headers.authorization;
  //console.log(auth);

  if (auth === 's3cret') {
    next();
  } else {
    console.error(`인증 실패: 전달받은 'Authorization'은 ${auth}`);
    res.status(401).json({ message: '권한이 없습니다.' });
  }
});

userRouter
  .route('/')
  .get((req, res, next) => {
    res.json({ message: '사용자 목록 보기' });
  })
  .post((req, res, next) => {
    res.json({ message: '사용자 추가하기' });
  });
userRouter
  .route('/:id')
  .patch((req, res, next) => {
    res.json({ message: '사용자 수정하기' });
  })
  .delete((req, res, next) => {
    res.json({ message: '사용자 삭제하기' });
  });

app.use('/users', userRouter);

app.listen(PORT, () => {
  console.log(`🚀 Server started on port ${PORT}`);
});
```

## 모범 답안

```js
import express from 'express';

const app = express();

// User Router
const userRouter = express.Router();

userRouter
  .route('/')
  .get((req, res, next) => {
    res.json({ message: '사용자 목록 보기' });
  })
  .post((req, res, next) => {
    res.json({ message: '사용자 추가하기' });
  });

userRouter
  .route('/:id')
  .patch((req, res, next) => {
    res.json({ message: '사용자 수정하기' });
  })
  .delete((req, res, next) => {
    res.json({ message: '사용자 삭제하기' });
  });

function adminOnly(req, res, next) {
  const authorization = req.get('Authorization');
  /* 리퀘스트의 헤더에서 특정 필드 이름으로 값을 가져오기 위해서는
   * req.get(HEADER_FIELD) 메소드를 사용하면 됩니다.
   * 해당 메소드로 가져온 값을 변수에 저장하도록 할게요. */
  if (authorization === 's3cret') {
    next();
  } else {
    res.status(401).json({ message: '권한이 없습니다.' });
  }
}

app.use('/users', adminOnly, userRouter);

// Product Router
const productRouter = express.Router();

productRouter
  .route('/')
  .get((req, res, next) => {
    res.json({ message: '상품 목록 보기' });
  })
  .post((req, res, next) => {
    res.json({ message: '상품 추가하기' });
  });

productRouter
  .route('/:id')
  .patch((req, res, next) => {
    res.json({ message: '상품 수정하기' });
  })
  .delete((req, res, next) => {
    res.json({ message: '상품 삭제하기' });
  });

app.use('/products', productRouter);

app.listen(3000, () => {
  console.log('Server is listening on port 3000');
});
```
