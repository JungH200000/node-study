## ğŸ“¦ Express í”„ë¡œì íŠ¸ êµ¬ì¡°ì™€ ëª¨ë“ˆí™”: ê¹”ë”í•˜ê²Œ ì •ë¦¬ ì •ëˆí•˜ê¸°

ì§€ê¸ˆê¹Œì§€ ìš°ë¦¬ëŠ” `app.js`ë¼ëŠ” ë‹¨ í•˜ë‚˜ì˜ íŒŒì¼ ì•ˆì—ì„œ ëª¨ë“  ì½”ë“œë¥¼ ì‘ì„±í•´ì™”ìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ í”„ë¡œì íŠ¸ê°€ ì»¤ì§ˆìˆ˜ë¡ `app.js` íŒŒì¼ì€ ì ì  ê¸¸ê³  ë³µì¡í•´ì ¸ì„œ ê´€ë¦¬í•˜ê¸° ì–´ë ¤ì›Œì§‘ë‹ˆë‹¤.

ì´ë²ˆì—ëŠ” ì´ë ‡ê²Œ í•œê³³ì— ëª¨ì—¬ìˆë˜ ì½”ë“œë¥¼ ê¸°ëŠ¥ì— ë”°ë¼ ë³„ë„ì˜ íŒŒì¼ë¡œ ë¶„ë¦¬í•˜ì—¬, ë” ì§ê´€ì ì´ê³  ê´€ë¦¬í•˜ê¸° ì¢‹ì€ êµ¬ì¡°ë¡œ ë§Œë“¤ì–´ ë³´ê² ìŠµë‹ˆë‹¤. ì´ ê³¼ì •ì„ **ëª¨ë“ˆí™”(Modularization)** ë¼ê³  í•©ë‹ˆë‹¤.

> ExpressëŠ” ì •í•´ì§„ í”„ë¡œì íŠ¸ êµ¬ì¡°ë¥¼ ê°•ìš”í•˜ì§€ ì•ŠëŠ” ìœ ì—°í•œ í”„ë ˆì„ì›Œí¬ì…ë‹ˆë‹¤. ë”°ë¼ì„œ ì§€ê¸ˆë¶€í„° ì†Œê°œí•˜ëŠ” êµ¬ì¡°ê°€ ìœ ì¼í•œ ì •ë‹µì€ ì•„ë‹ˆë©°, ê°€ì¥ ë„ë¦¬ ì“°ì´ëŠ” ë³´í¸ì ì¸ íŒ¨í„´ ì¤‘ í•˜ë‚˜ë¼ê³  ì´í•´í•˜ì‹œë©´ ì¢‹ìŠµë‹ˆë‹¤.

---

### ì‹œì‘ì : ëª¨ë“  ê²ƒì´ ë‹´ê¸´ `app.js`

ë¨¼ì € ë¦¬íŒ©í† ë§ì„ ì‹œì‘í•  í˜„ì¬ì˜ ì½”ë“œ êµ¬ì¡°ë¥¼ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤. `app` ë ˆë²¨ ë¯¸ë“¤ì›¨ì–´, `productRouter`, `userRouter` ë“± ëª¨ë“  ì½”ë“œê°€ `app.js` íŒŒì¼ í•˜ë‚˜ì— ëª¨ì—¬ ìˆìŠµë‹ˆë‹¤.

```javascript
// src/app.js (ë¦¬íŒ©í† ë§ ì „)
import express from 'express';

const app = express();
const PORT = 3000;

// 1. ì• í”Œë¦¬ì¼€ì´ì…˜ ë ˆë²¨ ë¯¸ë“¤ì›¨ì–´
app.use((req, res, next) => {
  console.log('ë‚˜ëŠ” í•­ìƒ ì‹¤í–‰!');
  next();
});

// 2. Product ê´€ë ¨ ë¼ìš°í„°
const productRouter = express.Router();
productRouter.use((req, res, next) => {
  console.log('Product Routerì—ì„œ í•­ìƒ ì‹¤í–‰!');
  next();
});
productRouter
  .route('/')
  .get((req, res) => {
    res.json({ message: 'Product ëª©ë¡ ë³´ê¸°' });
  })
  .post((req, res) => {
    res.json({ message: 'Product ì¶”ê°€í•˜ê¸°' });
  });

productRouter
  .route('/:id')
  .patch((req, res) => {
    res.json({ message: 'Product ìˆ˜ì •í•˜ê¸°' });
  })
  .delete((req, res) => {
    res.json({ message: 'Product ì‚­ì œí•˜ê¸°' });
  });

// 3. User ê´€ë ¨ ë¼ìš°í„°
const userRouter = express.Router();
userRouter.get('/', (req, res, next) => {
  res.json({ message: 'User ëª©ë¡ ë³´ê¸°' });
});
// 4. ë¼ìš°í„°ë“¤ì„ ì•±ì— ì—°ê²°
app.use('/products', productRouter);
app.use('/users', userRouter);

// 5. ì„œë²„ ì‹¤í–‰
app.listen(PORT, () => {
  console.log(`ğŸš€ Server started on port ${PORT}`);
});
```

---

### 1ë‹¨ê³„: ë¼ìš°í„° ë¶„ë¦¬í•˜ê¸° (feat. `routes` í´ë”)

ê°€ì¥ ë¨¼ì €, ê°ê¸° ë‹¤ë¥¸ ì£¼ì œë¥¼ ë‹¤ë£¨ëŠ” ë¼ìš°í„°ë“¤ì„ ë³„ë„ì˜ íŒŒì¼ë¡œ ë¶„ë¦¬í•´ ë³´ê² ìŠµë‹ˆë‹¤. ë§ˆì¹˜ ì±…ìƒ ìœ„ ì±…ë“¤ì„ ì£¼ì œë³„ë¡œ ë‚˜ëˆ  **ì±…ì¥(`routes` í´ë”)** ì— ê½‚ëŠ” ê²ƒê³¼ ê°™ìŠµë‹ˆë‹¤.

1.  `src` í´ë” ì•„ë˜ì— `routes` í´ë”ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.
2.  `routes` í´ë” ì•ˆì— `products.router.js`ì™€ `users.router.js` íŒŒì¼ì„ ë§Œë“­ë‹ˆë‹¤.
3.  `app.js`ì— ìˆë˜ ê° ë¼ìš°í„° ì½”ë“œë¥¼ ì˜ë¼ë‚´ì–´ í•´ë‹¹ íŒŒì¼ë¡œ ì˜®ê²¨ì¤ë‹ˆë‹¤.

**`src/routes/products.router.js`**

```javascript
import express from 'express';

const router = express.Router(); // productRouter -> routerë¡œ ì´ë¦„ ë³€ê²½ (ë” ì¼ë°˜ì )

// Product ë¼ìš°í„° ë ˆë²¨ ë¯¸ë“¤ì›¨ì–´
router.use((req, res, next) => {
  console.log('Product Routerì—ì„œ í•­ìƒ ì‹¤í–‰!');
  next();
});

// Product ê´€ë ¨ APIë“¤
router.route('/').get(/*...*/).post(/*...*/);
router.route('/:id').patch(/*...*/).delete(/*...*/);

// ì´ ë¼ìš°í„° ëª¨ë“ˆì„ ì™¸ë¶€ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ export í•©ë‹ˆë‹¤.
export default router;
```

**`src/routes/users.router.js`**

```javascript
import express from 'express';

const router = express.Router();

// User ê´€ë ¨ API
router.get('/', (req, res) => {
  res.json({ message: 'User ëª©ë¡ ë³´ê¸°' });
});

// ì´ ë¼ìš°í„° ëª¨ë“ˆì„ ì™¸ë¶€ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ export í•©ë‹ˆë‹¤.
export default router;
```

> **ğŸ’¡ `export default`ë€?**
> ES ëª¨ë“ˆ ë¬¸ë²•ìœ¼ë¡œ, "ì´ íŒŒì¼ì˜ ëŒ€í‘œì ì¸ ê¸°ëŠ¥ì€ ë°”ë¡œ ì´ `router` ê°ì²´ì…ë‹ˆë‹¤"ë¼ê³  ì™¸ë¶€ì— ì•Œë ¤ì£¼ëŠ” ì—­í• ì„ í•©ë‹ˆë‹¤. ì´ë ‡ê²Œ `export`ëœ ëª¨ë“ˆì€ ë‹¤ë¥¸ íŒŒì¼ì—ì„œ `import`í•˜ì—¬ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

---

### 2ë‹¨ê³„: ë¯¸ë“¤ì›¨ì–´ ë¶„ë¦¬í•˜ê¸° (feat. `middlewares` í´ë”)

ì´ì œ ê³µí†µì ìœ¼ë¡œ ì‚¬ìš©ë˜ëŠ” ë¯¸ë“¤ì›¨ì–´ë¥¼ ë¶„ë¦¬í•´ ë³´ê² ìŠµë‹ˆë‹¤. ì—¬ëŸ¬ ê³³ì—ì„œ ì“°ì´ëŠ” ì—°ì¥ë“¤ì„ **ë„êµ¬ ìƒì(`middlewares` í´ë”)** ì— ì •ë¦¬í•˜ëŠ” ê²ƒê³¼ ê°™ìŠµë‹ˆë‹¤.

1.  `src` í´ë” ì•„ë˜ì— `middlewares` í´ë”ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.
2.  `middlewares` í´ë” ì•ˆì— `log.middleware.js` íŒŒì¼ì„ ë§Œë“­ë‹ˆë‹¤.
3.  `app.js`ì— ìˆë˜ ì• í”Œë¦¬ì¼€ì´ì…˜ ë ˆë²¨ ë¯¸ë“¤ì›¨ì–´ ì½”ë“œë¥¼ ì˜®ê²¨ì¤ë‹ˆë‹¤.

**`src/middlewares/log.middleware.js`**

```javascript
// ë¯¸ë“¤ì›¨ì–´ëŠ” ê·¸ ìì²´ë¡œ í•¨ìˆ˜ì…ë‹ˆë‹¤.
function logMiddleware(req, res, next) {
  console.log('ë‚˜ëŠ” í•­ìƒ ì‹¤í–‰!');
  next();
}

// í•¨ìˆ˜ë¥¼ export í•©ë‹ˆë‹¤.
export default logMiddleware;
```

---

### ìµœì¢… ê²°ê³¼: ê¹”ë”í•´ì§„ `app.js`

ì´ì œ `app.js`ëŠ” ì–´ì§ˆëŸ¬ì§„ ë°©ì´ ì•„ë‹Œ, ì˜ ì •ë¦¬ëœ 'ê±°ì‹¤'ì˜ ì—­í• ì„ í•©ë‹ˆë‹¤. ê° ê¸°ëŠ¥(ë¼ìš°í„°, ë¯¸ë“¤ì›¨ì–´)ì„ `import`ë¡œ ê°€ì ¸ì™€ ì¡°ë¦½í•˜ê¸°ë§Œ í•˜ë©´ ë©ë‹ˆë‹¤.

**`src/app.js` (ë¦¬íŒ©í† ë§ í›„)**

```javascript
import express from 'express';
// 1. ë¶„ë¦¬ëœ ëª¨ë“ˆë“¤ì„ ê°€ì ¸ì˜µë‹ˆë‹¤(import).
import productRouter from './routes/products.router.js';
import userRouter from './routes/users.router.js';
import logMiddleware from './middlewares/log.middleware.js';

const app = express();
const PORT = 3000;

// 2. ë¯¸ë“¤ì›¨ì–´ë¥¼ ë“±ë¡í•©ë‹ˆë‹¤.
app.use(logMiddleware);

// 3. ë¼ìš°í„°ë¥¼ ë“±ë¡í•©ë‹ˆë‹¤.
app.use('/products', productRouter);
app.use('/users', userRouter);

// 4. ì„œë²„ë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤.
app.listen(PORT, () => {
  console.log(`ğŸš€ Server started on port ${PORT}`);
});
```

ì´ì œ í”„ë¡œì íŠ¸ì˜ êµ¬ì¡°ëŠ” ì•„ë˜ì™€ ê°™ì´ í›¨ì”¬ ë” ëª…í™•í•´ì¡ŒìŠµë‹ˆë‹¤.

```
src/
â”œâ”€â”€ middlewares/
â”‚   â””â”€â”€ log.middleware.js  (ê³µí†µ ë¯¸ë“¤ì›¨ì–´)
â”œâ”€â”€ routes/
â”‚   â”œâ”€â”€ products.router.js (ìƒí’ˆ API)
â”‚   â””â”€â”€ users.router.js    (ì‚¬ìš©ì API)
â””â”€â”€ app.js                 (ë©”ì¸ ì¡°ë¦½ íŒŒì¼)
```
