## 🧹 Express 라우트 중복 제거하기: `app.route()`로 코드 정리하기

Express로 API를 개발하다 보면, 하나의 경로(path)에 대해 여러 HTTP 메서드(`GET`, `POST`, `PATCH`, `DELETE` 등)를 처리하는 코드를 작성하게 됩니다. 이는 자연스러운 과정이지만, 자칫 코드의 중복을 유발하고 가독성을 떨어트릴 수 있습니다.

### 문제점: 반복되는 라우트 경로

아래는 상품(Product)에 대한 기본적인 CRUD API 코드입니다. 어떤 부분이 반복되고 있는지 한번 찾아보세요.

```javascript
// src/app.js
import express from 'express';

const app = express();
const PORT = 3000;

// '/products' 경로가 반복됩니다.
app.get('/products', (req, res) => {
  res.json({ message: 'Product 목록 보기' });
});
app.post('/products', (req, res) => {
  res.json({ message: 'Product 추가하기' });
});

// '/products/:id' 경로가 반복됩니다.
app.patch('/products/:id', (req, res) => {
  res.json({ message: 'Product 수정하기' });
});
app.delete('/products/:id', (req, res) => {
  res.json({ message: 'Product 삭제하기' });
});

app.listen(PORT, () => {
  console.log(`🚀 Server started on port ${PORT}`);
});
```

`'/products'`와 `'/products/:id'` 경로가 여러 번 반복해서 등장하는 것을 볼 수 있습니다. 프로젝트가 커질수록 이런 중복은 코드를 관리하기 어렵게 만듭니다.

---

### 해결책: `app.route()`로 경로 묶어주기

Express는 이렇게 중복되는 경로를 하나로 묶어 깔끔하게 관리할 수 있도록 **`app.route(path)`** 메서드를 제공합니다.

`app.route()`는 특정 경로에 대한 **'전용 서비스 창구'** 를 만드는 것과 같습니다. 이 창구를 한번 만들어두면, 그 뒤에 `.get()`, `.post()` 등 필요한 메서드 핸들러를 체인(chain)처럼 줄줄이 연결할 수 있습니다.

#### 리팩토링 과정

1.  `app.route('중복되는 경로')`를 선언합니다.
2.  해당 경로를 사용하던 기존 라우트(`app.get`, `app.post` 등)에서 경로 부분을 삭제합니다.
3.  삭제된 라우트의 메서드(`.get`, `.post` 등)와 핸들러 함수를 `app.route()` 뒤에 그대로 붙여줍니다.

```javascript
// src/app.js
import express from 'express';

const app = express();
const PORT = 3000;

// '/products' 경로에 대한 전용 창구를 만듭니다.
app
  .route('/products')
  // 이 창구로 오는 GET 요청은 여기서 처리합니다.
  .get((req, res) => {
    res.json({ message: 'Product 목록 보기' });
  })
  // 이 창구로 오는 POST 요청은 여기서 처리합니다.
  .post((req, res) => {
    res.json({ message: 'Product 추가하기' });
  });

// '/products/:id' 경로에 대한 전용 창구를 만듭니다.
app
  .route('/products/:id')
  // 이 창구로 오는 PATCH 요청은 여기서 처리합니다.
  .patch((req, res) => {
    res.json({ message: 'Product 수정하기' });
  })
  // 이 창구로 오는 DELETE 요청은 여기서 처리합니다.
  .delete((req, res) => {
    res.json({ message: 'Product 삭제하기' });
  });

app.listen(PORT, () => {
  console.log(`🚀 Server started on port ${PORT}`);
});
```
