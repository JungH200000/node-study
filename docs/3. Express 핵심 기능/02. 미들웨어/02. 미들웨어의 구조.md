## π”¬ λ―Έλ“¤μ›¨μ–΄μ κµ¬μ΅° νν—¤μΉκΈ°: νλΌλ―Έν„°μ λΉ„λ°€

μ§€λ‚ κΈ€μ—μ„ μ°λ¦¬λ” λΌμ°νΈ ν•Έλ“¤λ¬ ν•¨μκ°€ λ―Έλ“¤μ›¨μ–΄μ ν• μΆ…λ¥λΌλ” κ²ƒμ„ λ°°μ› μµλ‹λ‹¤. λ¨λ“  λ―Έλ“¤μ›¨μ–΄λ” **ν•¨μ** ν•νƒμ΄λ©°, Expressκ°€ μ‹¤ν–‰ν•  μ μλ„λ΅ λΌμ°νΈ λ©”μ„λ“ λ“±μ— **μΈμ(argument)** λ΅ μ „λ‹¬λ©λ‹λ‹¤. μ΄λ ‡κ² λ‚μ¤‘μ— μ‹¤ν–‰λλ„λ΅ μ „λ‹¬ν•λ” ν•¨μλ¥Ό **μ½λ°± ν•¨μ(Callback Function)** λΌκ³  λ¶€λ¦…λ‹λ‹¤.

Expressλ” μ΄ μ½λ°± ν•¨μλ¥Ό μ‹¤ν–‰ν•  λ•, μ •ν•΄μ§„ κ·μΉ™μ— λ”°λΌ μ—¬λ¬ μ μ©ν• 'λ„κµ¬'λ“¤μ„ νλΌλ―Έν„°λ΅ λ„£μ–΄μ¤λ‹λ‹¤. λ―Έλ“¤μ›¨μ–΄ ν•¨μκ°€ λ‡ κ°μ νλΌλ―Έν„°λ¥Ό κ°–λ„λ΅ μ •μν–λ”μ§€μ— λ”°λΌ Expressκ°€ λ„£μ–΄μ£Όλ” 'λ„κµ¬'μ μΆ…λ¥κ°€ λ‹¬λΌμ§‘λ‹λ‹¤.

λ―Έλ“¤μ›¨μ–΄λ” **2κ°, 3κ°, λλ” 4κ°**μ νλΌλ―Έν„°λ¥Ό κ°€μ§ μ μμµλ‹λ‹¤. κ°κ° μ–΄λ–¤ μ—­ν• μ„ ν•λ”μ§€ μ½”λ“λ¥Ό ν†µν•΄ κ°€λ³κ² μ•μ•„λ³΄κ² μµλ‹λ‹¤.
μμ„Έν• μ‚¬μ©λ²•μ€ λ‚μ¤‘μ— ν•™μµν•  μμ •μ…λ‹λ‹¤.

---

### 1\. νλΌλ―Έν„° 2κ°: `(req, res)` - κΈ°λ³Έ μ”μ²­ ν•Έλ“¤λ¬

κ°€μ¥ κΈ°λ³Έμ μ΄κ³  κ°€μ¥ λ§μ΄ μ‚¬μ©λλ” ν•νƒμ λ―Έλ“¤μ›¨μ–΄μ…λ‹λ‹¤.

- `req` (**Request**): ν΄λΌμ΄μ–ΈνΈμ **μ”μ²­**μ— λ€ν• λ¨λ“  μ •λ³΄κ°€ λ‹΄κΈ΄ κ°μ²΄μ…λ‹λ‹¤.
- `res` (**Response**): ν΄λΌμ΄μ–ΈνΈμ—κ² λ³΄λ‚Ό **μ‘λ‹µ**μ„ λ§λ“¤ λ• μ‚¬μ©ν•λ” κ°μ²΄μ…λ‹λ‹¤.

```javascript
// src/app.js
import express from 'express';

const app = express();
const PORT = 3000;

function greeting(req, res) {
  // req κ°μ²΄μ—λ” μ–΄λ–¤ μ •λ³΄κ°€ λ‹΄κ²¨μμ„κΉμ”?
  // ν„°λ―Έλ„μ—μ„ ν™•μΈν•΄ λ΄…μ‹λ‹¤.
  console.log(req);
  res.json({ message: 'μ•λ…•ν•μ„Έμ”, λ°κ°€μ›μ”!' });
}

app.get('/hello', greeting);

app.listen(PORT, () => {
  console.log(`π€ Server started on port ${PORT}`);
});
```

`req` κ°μ²΄ μ•μ—λ” μ”μ²­ URL, HTTP λ©”μ„λ“, ν—¤λ”, μΏΌλ¦¬ μ¤νΈλ§ λ“± λ°©λ€ν• μ •λ³΄κ°€ λ“¤μ–΄μμµλ‹λ‹¤. λ§μ°¬κ°€μ§€λ΅ `res` κ°μ²΄μ—λ” μ‘λ‹µμ„ λ³΄λ‚΄λ” `.json()`, `.send()` κ°™μ€ μ μ©ν• λ©”μ„λ“λ“¤μ΄ ν¬ν•¨λμ–΄ μμµλ‹λ‹¤.

> **π’΅ λ¨λ“  κ²ƒμ„ μ™ΈμΈ ν•„μ”λ” μ—†μ–΄μ”\!** > `req`μ™€ `res` κ°μ²΄μ λ¨λ“  μ†μ„±μ„ μ™ΈμΈ ν•„μ”λ” μ—†μµλ‹λ‹¤. `req.params`, `req.query`, `req.body`μ²λΌ μμ£Ό μ‚¬μ©ν•λ” λ‡ κ°€μ§€λ§ μµμ™ν•΄μ§€λ©΄ μ¶©λ¶„ν•©λ‹λ‹¤. λ” μμ„Έν• λ‚΄μ©μ΄ κ¶κΈν•  λ• μ–Έμ λ“ μ§€ [Express κ³µμ‹ λ¬Έμ„ - Request Properties](https://expressjs.com/ko/api.html#req)λ¥Ό μ°Έκ³ ν•λ” μµκ΄€μ„ λ“¤μ΄λ” κ²ƒμ΄ μΆ‹μµλ‹λ‹¤.

---

### 2\. νλΌλ―Έν„° 3κ°: `(req, res, next)` - λ‹¤μμΌλ΅ λ„κΈ°κΈ°

μ„Έ λ²μ§Έ νλΌλ―Έν„°λ΅ `next` ν•¨μκ°€ μ¶”κ°€λ ν•νƒμ…λ‹λ‹¤.

- `next`: ν„μ¬ λ―Έλ“¤μ›¨μ–΄μ μ—­ν• μ„ λ‹¤ λ§μΉ λ’¤, **λ‹¤μ λ―Έλ“¤μ›¨μ–΄λ΅ μ μ–΄κ¶μ„ λ„κΈ°λ”** ν•¨μμ…λ‹λ‹¤.

ν•λ‚μ μ”μ²­μ€ μ—¬λ¬ κ°μ λ―Έλ“¤μ›¨μ–΄λ¥Ό μ—°λ‹¬μ•„ κ±°μΉ  μ μμµλ‹λ‹¤. μ΄λ• `next()` ν•¨μλ¥Ό νΈμ¶ν•λ©΄ Expressλ” ν„μ¬ μ”μ²­μ„ λ‹¤μ λ―Έλ“¤μ›¨μ–΄ ν•¨μμ—κ² μ „λ‹¬ν•©λ‹λ‹¤.

```javascript
// src/app.js
// (Express, app, PORT μ„¤μ •μ€ μ„μ™€ λ™μΌ)

function greeting(req, res, next) {
  console.log('μ²« λ²μ§Έ λ―Έλ“¤μ›¨μ–΄μ…λ‹λ‹¤!');
  // res.json(...)μ²λΌ μ‘λ‹µμ„ λ³΄λ‚΄μ§€ μ•κ³ ,
  // next()λ¥Ό νΈμ¶ν•λ©΄ λ‹¤μ λ―Έλ“¤μ›¨μ–΄λ΅ λ„μ–΄κ°‘λ‹λ‹¤.
  next();
}

function sayHello(req, res) {
  console.log('λ‘ λ²μ§Έ λ―Έλ“¤μ›¨μ–΄μ…λ‹λ‹¤!');
  res.json({ message: 'μ•λ…•ν•μ„Έμ”, λ°κ°€μ›μ”!' });
}

// '/hello' κ²½λ΅μ— λ‘ κ°μ λ―Έλ“¤μ›¨μ–΄λ¥Ό λ°°μ—΄λ΅ μ—°κ²°ν–μµλ‹λ‹¤.
app.get('/hello', [greeting, sayHello]);

// (app.listen μ½”λ“λ” μ„μ™€ λ™μΌ)
```

μ„ μμ μ²λΌ `next()`λ” ν•λ‚μ μ”μ²­μ— λ€ν•΄ μ—¬λ¬ λ‹¨κ³„μ μ²λ¦¬κ°€ ν•„μ”ν•  λ• μ‚¬μ©λ©λ‹λ‹¤. (μμ„Έν• ν™μ©λ²•μ€ λ‚μ¤‘μ— λ‹¤λ£° μμ •μ…λ‹λ‹¤.)

---

### 3\. νλΌλ―Έν„° 4κ°: `(err, req, res, next)` - μ¤λ¥ μ²λ¦¬ μ „λ‹΄

νλΌλ―Έν„°κ°€ 4κ°μΈ κ²½μ°λ” μ•„μ£Ό νΉλ³„ν• λ©μ μ„ κ°€μ§‘λ‹λ‹¤. λ°”λ΅ **μ¤λ¥ μ²λ¦¬(Error Handling)** μ…λ‹λ‹¤.

- `err`: λ‹¤λ¥Έ λ―Έλ“¤μ›¨μ–΄μ—μ„ λ°μƒν• **μ¤λ¥** μ •λ³΄κ°€ λ‹΄κΈ°λ” κ°μ²΄μ…λ‹λ‹¤.

μ΄ λ―Έλ“¤μ›¨μ–΄λ” μΌλ°μ μΈ μ”μ²­ νλ¦„μ—μ„λ” μ‹¤ν–‰λμ§€ μ•μµλ‹λ‹¤. λ‹¤λ¥Έ λ―Έλ“¤μ›¨μ–΄μ—μ„ μ¤λ¥κ°€ λ°μƒν–μ„ λ•(`throw` μ‚¬μ©) λλ” `next()` ν•¨μμ— μΈμ(`next(error)`)λ¥Ό μ „λ‹¬ν–μ„ λ•λ§ μ‹¤ν–‰λλ” 'μ¤λ¥ μ²λ¦¬ μ „λ‹΄ν€'κ³Ό κ°™μµλ‹λ‹¤. μ²« λ²μ§Έ νλΌλ―Έν„°λ΅ `err`κ°€ μ¨λ‹¤λ” μ κ³Ό κ·Έ μμ„κ°€ λ§¤μ° μ¤‘μ”ν•©λ‹λ‹¤.

```javascript
// src/app.js
// (Express, app, PORT μ„¤μ •μ€ μ„μ™€ λ™μΌ)

// λ‹¤λ¥Έ λ―Έλ“¤μ›¨μ–΄λ“¤...

// μ¤λ¥ μ²λ¦¬ λ―Έλ“¤μ›¨μ–΄λ” λ³΄ν†µ μ„λ²„ μ½”λ“μ κ°€μ¥ λ§μ§€λ§‰μ— μ •μν•©λ‹λ‹¤.
function errorHandler(err, req, res, next) {
  console.error(err); // λ°μƒν• μ—λ¬λ¥Ό μ½μ†”μ— μ¶λ ¥
  res.status(500).json({ message: 'μ„λ²„ λ‚΄λ¶€μ—μ„ μ¤λ¥κ°€ λ°μƒν–μµλ‹λ‹¤.' });
}

// (app.listen μ½”λ“λ” μ„μ™€ λ™μΌ)
```

μ¤λ¥ μ²λ¦¬ λ―Έλ“¤μ›¨μ–΄(Error Handler)μ— λ€ν•΄μ„λ„ λ‚μ¤‘μ— λ” μμ„Έν ν•™μµν•  μμ •μ΄λ‹, μ§€κΈμ€ "μ•„, νλΌλ―Έν„° 4κ°μ§λ¦¬λ” μ—λ¬λ¥Ό μ²λ¦¬ν•λ” νΉλ³„ν• λ―Έλ“¤μ›¨μ–΄κµ¬λ‚\!" μ •λ„λ΅λ§ κΈ°μ–µν•΄ μ£Όμ„Έμ”.
