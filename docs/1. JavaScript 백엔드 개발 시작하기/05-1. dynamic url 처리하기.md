## π― Dynamic URL μ²λ¦¬ν•κΈ°

μ›Ή μ„λΉ„μ¤λ¥Ό λ§λ“¤λ‹¤ λ³΄λ©΄ URLμ΄ κ³ μ •λμ–΄ μμ§€ μ•κ³ , νΉμ • κ°’μ— λ”°λΌ λ™μ μΌλ΅ λ°”λ€μ–΄μ•Ό ν•  λ•κ°€ λ§μµλ‹λ‹¤. μλ¥Ό λ“¤μ–΄, ν•  μΌ(Task)μ μƒμ„Έ μ •λ³΄λ¥Ό λ³΄λ” νμ΄μ§€λ” ν•  μΌμ κ³ μ  IDμ— λ”°λΌ `/tasks/1`, `/tasks/2` μ™€ κ°™μ΄ κ°κ° λ‹¤λ¥Έ URLμ„ κ°€μ Έμ•Ό ν•μ£ .

μμ², μλ§ κ°μ ν•  μΌμ΄ μƒκΈΈ λ•λ§λ‹¤ λ¨λ“  URL κ²½λ΅λ¥Ό λ―Έλ¦¬ λ§λ“¤μ–΄ λ‘ μλ” μ—†μµλ‹λ‹¤. μ΄λ΄ λ• μ‚¬μ©ν•λ” κ²ƒμ΄ λ°”λ΅ **λ‹¤μ΄λ‚λ―Ή URL(Dynamic URL)** λλ” **λ™μ  λΌμ°ν…(Dynamic Routing)** μ…λ‹λ‹¤.

Expressμ—μ„λ” μ΄λ° λ™μ  URLμ„ λ§¤μ° κ°„λ‹¨ν•κ² μ²λ¦¬ν•  μ μμµλ‹λ‹¤. URLμ—μ„ λ™μ μΌλ΅ λ³€ν•λ” λ¶€λ¶„μ„ **URL νλΌλ―Έν„°(URL Parameter)** λ΅ μ§€μ •ν•λ” λ°©μ‹μ…λ‹λ‹¤.

```javascript
app.get('/tasks/:id', (req, res) => {
  // :id λ¶€λ¶„μ— μ–΄λ–¤ κ°’μ΄ λ“¤μ–΄μ™€λ„ μ΄ ν•Έλ“¤λ¬κ°€ μ‹¤ν–‰λ©λ‹λ‹¤.
});
```

μ„ μ½”λ“μ²λΌ κ²½λ΅μ— μ½λ΅ (`:`)μ„ μ‚¬μ©ν•κ³  λ’¤μ— νλΌλ―Έν„° μ΄λ¦„μ„ μ§€μ •ν•λ©΄ λ©λ‹λ‹¤. μ—¬κΈ°μ„ `:id`κ°€ λ°”λ΅ URL νλΌλ―Έν„°μ΄λ©°, 'id'λΌλ” μ΄λ¦„μΌλ΅ ν•΄λ‹Ή μ„μΉμ κ°’μ„ λ°›μ•„μ¬ μ μμµλ‹λ‹¤.

### β“ URL νλΌλ―Έν„°λ” μ–΄λ–»κ² κ°€μ Έμ¬κΉμ”?

Expressλ” URL νλΌλ―Έν„°λ΅ λ“¤μ–΄μ¨ κ°’μ„ μλ™μΌλ΅ `request` κ°μ²΄μ `params` ν”„λ΅νΌν‹°μ— λ‹΄μ•„μ¤λ‹λ‹¤. λ§μ•½ μ°λ¦¬κ°€ `:id`λΌκ³  μ΄λ¦„μ„ μ§€μ—λ‹¤λ©΄, `req.params.id`λ΅ κ·Έ κ°’μ„ κΊΌλ‚΄ μ“Έ μ μμµλ‹λ‹¤.

μ•„λ μ „μ²΄ μ½”λ“λ¥Ό λ³΄λ©° μ‹¤μ λ΅ μ–΄λ–»κ² νΉμ • IDλ¥Ό κ°€μ§„ ν•  μΌμ„ μ°Ύκ³ , λ§μ•½ μ΅΄μ¬ν•μ§€ μ•μ„ κ²½μ° μ–΄λ–»κ² μ²λ¦¬ν•λ”μ§€ μ‚΄ν΄λ³΄κ² μµλ‹λ‹¤.

### π’» μ „μ²΄ μ½”λ“ μμ‹

```js
// node01-start-javascript-backend/todo-api/app.js
import express from 'express';
import tasks from './data/mock.js';

const app = express();

// --- λ¨λ“  ν•  μΌ λ©λ΅ κ°€μ Έμ¤κΈ° (μ •λ ¬ λ° κ°μ μ ν• κΈ°λ¥ ν¬ν•¨) ---
app.get('/tasks', (req, res) => {
  /**
   * μΏΌλ¦¬ νλΌλ―Έν„°λ¥Ό λ°›μ•„ task λ©λ΅μ„ μ •λ ¬ν•κ³  κ°μλ¥Ό μ ν•ν•©λ‹λ‹¤.
   * sort - 'oldest'μΈ κ²½μ° μ¤λλ μ, κ·Έ μ™Έμ—λ” μµμ‹  μμΌλ΅ μ •λ ¬ν•©λ‹λ‹¤. (κΈ°λ³Έκ°’: μµμ‹  μ)
   * count - μ‘λ‹µμΌλ΅ λ³΄λ‚Ό taskμ μµλ€ κ°μμ…λ‹λ‹¤.
   */
  const { sort, count: countStr } = req.query;
  const count = Number(countStr);

  const compareFn = sort === 'oldest' ? (a, b) => a.createdAt - b.createdAt : (a, b) => b.createdAt - a.createdAt;

  let newTasks = [...tasks].sort(compareFn);

  if (count) {
    newTasks = newTasks.slice(0, count);
  }

  res.send(newTasks);
});

// --- νΉμ • IDλ¥Ό κ°€μ§„ ν•  μΌ μ •λ³΄ κ°€μ Έμ¤κΈ° (Dynamic URL μ²λ¦¬) ---
app.get('/tasks/:id', (req, res) => {
  // 1. req.params κ°μ²΄μ—μ„ URL νλΌλ―Έν„°(:id) κ°’μ„ κ°€μ Έμµλ‹λ‹¤.
  //    URLμ„ ν†µν•΄ μ „λ‹¬λ κ°’μ€ κΈ°λ³Έμ μΌλ΅ 'λ¬Έμμ—΄'μ΄λ―€λ΅, μ«μμ™€ λΉ„κµν•κΈ° μ„ν•΄ Number()λ΅ λ³€ν™ν•©λ‹λ‹¤.
  const id = Number(req.params.id);

  // 2. tasks λ°°μ—΄μ—μ„ μ”μ²­λ idμ™€ μΌμΉν•λ” ν•  μΌμ„ μ°Ύμµλ‹λ‹¤.
  const task = tasks.find((task) => task.id === id);

  // 3. ν•  μΌμ„ μ°Ύμ•λ”μ§€ ν™•μΈν•©λ‹λ‹¤.
  if (task) {
    // 3-1. ν•  μΌμ„ μ°Ύμ•λ‹¤λ©΄, ν•΄λ‹Ή ν•  μΌ μ •λ³΄λ¥Ό μ‘λ‹µμΌλ΅ λ³΄λƒ…λ‹λ‹¤.
    res.send(task);
  } else {
    // 3-2. ν•  μΌμ„ μ°Ύμ§€ λ»ν–λ‹¤λ©΄, ν΄λΌμ΄μ–ΈνΈμ—κ² λ¦¬μ†μ¤λ¥Ό μ°Ύμ„ μ μ—†λ‹¤λ” κ²ƒμ„ λ…ν™•ν μ•λ ¤μ¤λ‹λ‹¤.
    //      HTTP μƒνƒ μ½”λ“ 404 Not Foundλ¥Ό μ„¤μ •ν•λ” κ²ƒμ΄ μΌλ°μ μΈ REST API κ·μΉ™μ…λ‹λ‹¤.
    res.status(404).send({ message: 'Cannot find given id.' });
  }
});

app.listen(3000, () => {
  console.log('Server started on port 3000');
  console.log(`http://localhost:3000`);
});
```

### β… μ‹¤ν–‰ κ²°κ³Ό ν™•μΈν•κΈ°

VS Codeμ REST Clientμ™€ κ°™μ€ λ„κµ¬λ¥Ό μ‚¬μ©ν•΄ APIλ¥Ό ν…μ¤νΈν•΄λ³΄κ² μµλ‹λ‹¤.

#### 1\. IDκ°€ 1μΈ ν•  μΌ μ΅°ν (μ„±κ³µ μΌ€μ΄μ¤)

`requests.http` νμΌμ— μ•„λμ™€ κ°™μ΄ μ‘μ„±ν•κ³  `Send Request`λ¥Ό μ‹¤ν–‰ν•©λ‹λ‹¤.

```http
GET http://localhost:3000/tasks/1
```

**[μ‘λ‹µ κ²°κ³Ό]**
μ„λ²„λ” IDκ°€ 1μΈ ν•  μΌ λ°μ΄ν„°λ¥Ό μ„±κ³µμ μΌλ΅ μ°Ύμ•„ `200 OK` μƒνƒ μ½”λ“μ™€ ν•¨κ» JSON ν•μ‹μΌλ΅ μ‘λ‹µν•©λ‹λ‹¤.

```json
HTTP/1.1 200 OK
Content-Type: application/json; charset=utf-8
// ... κΈ°νƒ€ ν—¤λ”

{
  "id": 1,
  "title": "30λ¶„ μ΄λ™",
  "isComplete": false,
  "createdAt": "2023-03-23T06:34:07.617Z",
  "updatedAt": "2023-03-23T06:34:07.617Z"
}
```

#### 2\. μ΅΄μ¬ν•μ§€ μ•λ” ID μ΅°ν (μ‹¤ν¨ μΌ€μ΄μ¤)

μ΄λ²μ—λ” λ°μ΄ν„°μ— μ—†λ” ID(μ: 10)λ¥Ό μ”μ²­ν•΄ λ³΄κ² μµλ‹λ‹¤.

```http
GET http://localhost:3000/tasks/10
```

**[μ‘λ‹µ κ²°κ³Ό]**
μ½”λ“μ—μ„ `find` λ©”μ†λ“λ΅ ν•  μΌμ„ μ°Ύμ§€ λ»ν–κΈ° λ•λ¬Έμ— `else` λΈ”λ΅μ΄ μ‹¤ν–‰λ©λ‹λ‹¤. `404 Not Found` μƒνƒ μ½”λ“μ™€ ν•¨κ» μ°λ¦¬κ°€ μ§€μ •ν• μ—λ¬ λ©”μ‹μ§€κ°€ λ‹΄κΈ΄ JSON κ°μ²΄κ°€ μ‘λ‹µμΌλ΅ λμ•„μµλ‹λ‹¤.

```json
HTTP/1.1 404 Not Found
Content-Type: application/json; charset=utf-8
// ... κΈ°νƒ€ ν—¤λ”

{
  "message": "Cannot find given id."
}
```

μ΄μ²λΌ λ‹¤μ΄λ‚λ―Ή URLμ„ ν™μ©ν•λ©΄, λ³€ν™”ν•λ” κ°’μ— λ”°λΌ κ°κ° λ‹¤λ¥Έ λ°μ΄ν„°λ¥Ό λ³΄μ—¬μ£Όλ” APIλ¥Ό ν¨μ¨μ μΌλ΅ κµ¬ν„ν•  μ μμµλ‹λ‹¤. π
