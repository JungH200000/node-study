## Express로 첫 라우트(Route) 만들기

이제 Express를 사용하여 첫 번째 **라우트(Route)** 를 만들어 보겠습니다. 여기서 라우트란, 특정 엔드포인트(URL + HTTP 메서드)에 대한 요청을 처리하는 코드 블록을 의미합니다.

먼저, 프로젝트 폴더(`todo-api/`)에 `app.js` 파일을 생성하고 아래 코드를 작성합니다.

```javascript
// node01-start-javascript-backend/todo-api/app.js
import express from 'express';

const app = express();

// '/hello' 경로로 들어오는 GET 요청을 처리하는 라우트
app.get('/hello', (req, res) => {
  // 여기에 요청을 처리하는 코드를 작성합니다.
});
```

위 코드의 `app.get(...)` 부분이 바로 라우트를 정의하는 코드입니다.

- `app.get('/hello', ...)`: 서버에 `GET /hello` 요청이 들어오면 두 번째 인자로 전달된 콜백 함수를 실행하라는 의미입니다. HTTP 메서드에 따라 `app.post()`, `app.delete()` 등 `app` 객체의 다양한 메서드를 사용할 수 있습니다.
- `(req, res) => {}`: 이 함수는 요청을 직접 처리하기 때문에 **요청 핸들러(Request Handler)** 라고 부릅니다. 요청 핸들러는 2개의 파라미터를 받습니다.
  - `req`: 들어온 **요청(Request)** 에 대한 정보가 담긴 객체입니다.
  - `res`: 클라이언트에게 돌려줄 **응답(Response)** 을 다루는 객체입니다.

---

### 서버 실행 및 응답 보내기

이제 실제로 서버를 실행하고, 요청에 대한 응답으로 간단한 문자열을 보내보겠습니다.

```javascript
// node01-start-javascript-backend/todo-api/app.js
import express from 'express';

const app = express();

app.get('/hello', (req, res) => {
  // res.send()를 사용해 클라이언트에 응답을 보냅니다.
  res.send('Hello Express!');
});

// 3000번 포트에서 서버를 실행합니다.
app.listen(3000, () => {
  console.log('Server started on port 3000');
});
```

- `res.send(...)`: 응답 객체(`res`)의 `send` 메서드를 사용하면 클라이언트에 데이터를 보낼 수 있습니다. `res.send()`는 기본적으로 `200 OK` 상태 코드를 함께 보냅니다.
- `app.listen(3000, ...)`: `listen` 메서드는 특정 **포트(Port)** 에서 외부의 요청을 기다리도록 서버를 실행합니다. 포트란 컴퓨터 내에서 실행되는 여러 프로그램을 구분하기 위한 번호입니다. 서버가 성공적으로 시작되면 콜백 함수가 실행됩니다.

이제 터미널에서 아래 명령어로 서버를 실행합니다.

```bash
node app.js
```

터미널에 `Server started on port 3000`이 출력되면 서버가 성공적으로 실행된 것입니다.

---

### 라우트 테스트하기

서버가 잘 작동하는지 두 가지 방법으로 확인해 보겠습니다.

#### 1\. 웹 브라우저로 확인하기

웹 브라우저 주소창에 `http://localhost:3000/hello`를 입력하고 접속합니다.

- `localhost`는 현재 사용 중인 컴퓨터를 의미합니다.
- `:3000`은 우리가 지정한 포트 번호입니다.

화면에 `Hello Express!`가 잘 출력되는 것을 볼 수 있습니다. 하지만 주소창에 URL을 입력하는 방식은 **`GET` 요청만 보낼 수 있다는 한계**가 있습니다.

#### 2\. REST Client로 확인하기

다양한 HTTP 메서드(`POST`, `PATCH`, `DELETE` 등)를 테스트하기 위해 이전에 설치한 VS Code의 **REST Client** 확장 프로그램을 사용합니다.

프로젝트 폴더에 `requests.http` 파일을 만들고 아래 내용을 작성합니다.

```http
GET http://localhost:3000/hello
```

코드 바로 위에 나타나는 `Send Request` 버튼을 클릭하면 VS Code 오른쪽에 응답 결과가 나타납니다.

```
HTTP/1.1 200 OK
X-Powered-by: Express
Content-Type: text/html; charset=utf-8
Content-Length: 14
...

Hello Express!
```

상태 코드 `200 OK`와 함께 우리가 보낸 문자열이 잘 도착한 것을 확인할 수 있습니다.

---

### `nodemon`으로 서버 자동 재시작하기

지금까지의 방식으로는 코드를 수정한 뒤 변경 사항을 확인하려면, `Ctrl + C`로 서버를 껐다가 `node app.js`로 다시 켜야 하는 번거로움이 있습니다.

이때 **`nodemon`** 을 사용하면 코드가 변경될 때마다 서버를 자동으로 재시작해 줍니다.

`package.json` 파일의 `scripts` 부분을 아래와 같이 수정합니다.

```json
  "scripts": {
    "dev": "nodemon app.js",
    "start": "node app.js"
  },
```

- `"dev"`: 개발 환경에서 `nodemon`으로 서버를 실행하는 명령어입니다.
- `"start"`: 실제 서비스(운영) 환경에서 `node`로 서버를 실행하는 명령어입니다. 개발 중에는 코드가 계속 바뀌지만, 운영 환경에서는 한번 켜두면 바뀔 일이 거의 없기 때문에 이렇게 구분하는 것이 일반적입니다.

이제 터미널에서 아래 명령어로 서버를 실행합니다.

```bash
npm run dev
```

`nodemon`으로 서버가 실행된 것을 확인한 후, `app.js` 파일의 내용을 아래와 같이 수정하고 저장해 보세요.

```javascript
// node01-start-javascript-backend/todo-api/app.js
// ... (생략) ...
app.get('/hello', (req, res) => {
  res.send('Bye Express!'); // 내용을 수정
});
// ... (생략) ...
```

파일을 저장하는 즉시 터미널에서 `nodemon`이 서버를 재시작하는 것을 볼 수 있습니다. 이제 웹 브라우저를 새로고침하거나 REST Client에서 `Send Request`를 다시 클릭하면, `Bye Express!`로 변경된 내용이 바로 반영되는 것을 확인할 수 있습니다.
