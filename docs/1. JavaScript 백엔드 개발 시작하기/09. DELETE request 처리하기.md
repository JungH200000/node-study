## 🗑️ 데이터 삭제하기: DELETE 요청 처리 완벽 가이드

이제 API의 마지막 핵심 기능, 바로 데이터를 **삭제**하는 `DELETE` 요청을 처리하는 방법을 알아보겠습니다. 할 일(Task) 목록에서 특정 할 일을 삭제하는 기능을 구현해 봅시다.

`DELETE` 요청은 특정 리소스를 삭제하는 것이 목적이므로, `POST`나 `PATCH`와 달리 요청 본문(Body)이 필요 없는 경우가 대부분입니다. 어떤 대상을 삭제할지만 URL을 통해 알려주면 됩니다.

### 1. Express로 DELETE 라우트 만들기

서버에서 특정 ID의 할 일을 삭제하는 요청을 받아 처리하는 코드를 `app.js`에 추가해 보겠습니다.

#### 💻 전체 코드

`app.delete('/tasks/:id', ...)` 라우트 핸들러를 추가한 전체 코드는 다음과 같습니다.

```js
// node01-start-javascript-backend/todo-api/app.js
import express from 'express';
// ❗️참고: 실제 프로젝트에서는 tasks 배열을 직접 수정하는 방식 대신 데이터베이스를 사용합니다.
// 서버가 재시작되면 변경 사항이 사라지므로, 현재는 mock 데이터로만 테스트합니다.
let tasks = require('./data/mock.js').default;

const app = express();
app.use(express.json());

// --- GET, POST, PATCH 라우트 (이전과 동일) ---
app.get('/tasks', (req, res) => {
  /* ... */
});
app.get('/tasks/:id', (req, res) => {
  /* ... */
});
app.post('/tasks', (req, res) => {
  /* ... */
});
app.patch('/tasks/:id', (req, res) => {
  /* ... */
});

// --- 특정 할 일 삭제하기 ---
app.delete('/tasks/:id', (req, res) => {
  // 1. URL 파라미터에서 삭제할 task의 id를 가져와 숫자로 변환합니다.
  const id = Number(req.params.id);

  // 2. findIndex()를 사용해 해당 task가 배열의 몇 번째에 있는지 인덱스를 찾습니다.
  const idx = tasks.findIndex((task) => task.id === id);

  // 3. findIndex()는 요소를 찾으면 해당 인덱스를, 못 찾으면 -1을 반환합니다.
  if (idx >= 0) {
    // 4. 인덱스를 찾았다면, splice() 메소드로 배열에서 해당 요소를 삭제합니다.
    //    splice(시작_인덱스, 삭제할_개수)
    tasks.splice(idx, 1);

    // 5. 리소스가 성공적으로 삭제되었을 때는 204 No Content 상태 코드를 보내는 것이 표준입니다.
    //    '성공했지만 본문(Body)은 없다'는 의미를 가집니다.
    res.sendStatus(204);
  } else {
    // 3-1. 인덱스가 -1이라면, 해당 id의 task가 없다는 의미이므로 404 에러를 응답합니다.
    res.status(404).send({ message: 'Cannot find given id.' });
  }
});

app.listen(3000, () => {
  console.log('Server started on port 3000');
  console.log(`http://localhost:3000`);
});
```

### 2. 실행 결과 확인하기

서버를 실행하고 `DELETE` 요청을 보내서 데이터가 정말 삭제되는지 확인해 봅시다.

#### ✅ 성공 케이스: 데이터 삭제

ID가 1인 할 일을 삭제하는 요청을 보냅니다. 본문은 필요 없습니다.

**[요청]**

```http
DELETE http://localhost:3000/tasks/1
```

**[응답]**
성공적으로 삭제되면 서버는 `204 No Content` 상태 코드만 응답합니다. 이름 그대로, 응답 본문(Body)에는 아무 내용이 없습니다.

```
HTTP/1.1 204 No Content
Date: Thu, 21 Aug 2025 14:01:09 GMT
Connection: close
```

**[삭제 확인]**
`GET http://localhost:3000/tasks` 요청을 다시 보내보면, ID가 1이었던 할 일이 목록에서 사라진 것을 확인할 수 있습니다.

#### ❌ 실패 케이스: 없는 데이터 삭제 시도

이미 삭제된 ID 1에 대해 다시 한번 `DELETE` 요청을 보내면, `if (idx >= 0)` 조건이 `false`가 되므로 `else` 블록이 실행되어 `404 Not Found` 에러가 정상적으로 응답됩니다.

**[요청]**

```http
DELETE http://localhost:3000/tasks/1
```

**[응답]**

```json
HTTP/1.1 404 Not Found
// ...

{
  "message": "Cannot find given id."
}
```

이로써 데이터를 조회(GET), 생성(POST), 수정(PATCH), 삭제(DELETE)하는 기본적인 **CRUD** API 기능 구현이 모두 완료되었습니다\! 🎉
