## [API 디자인] POST, PUT, PATCH는 어떻게 다를까? 🤔

REST API를 설계하다 보면 자원을 생성하고 수정하는 과정에서 `POST`, `PUT`, `PATCH`라는 세 가지 HTTP 메서드를 만나게 됩니다. 이들은 기술적으로는 큰 차이가 없지만, API의 명확성과 일관성을 위해 **의미(Semantic)에 따라 구분해서 사용하는 것이 매우 중요**합니다.

> **'의미'에 따른 구분이란?**
>
> 기술적으로는 `POST` 요청으로 데이터를 수정하거나, `PUT` 요청으로 데이터를 생성하는 코드를 작성할 수 있습니다. 하지만 이는 API를 사용하는 개발자에게 큰 혼란을 줍니다. 마치 '삭제' 버튼을 눌렀는데 '저장' 기능이 동작하는 것과 같죠.
>
> 따라서 우리는 [HTTP 명세(Specification)](https://datatracker.ietf.org/doc/html/rfc9110)에 정의된 **사회적인 약속**에 따라 각 메서드를 의미에 맞게 사용해야 합니다.

일반적으로 통용되는 약속은 다음과 같습니다.

- **POST**: 새로운 자원을 **생성(Create)** 할 때 사용합니다.
- **PUT / PATCH**: 기존 자원을 **수정(Update)** 할 때 사용합니다.

이번 글에서는 특히 헷갈리기 쉬운 `PUT`과 `PATCH`의 차이점을 예시와 함께 명확하게 알아보겠습니다.

---

### PUT vs PATCH: 전체 교체와 부분 수정

`PUT`과 `PATCH`는 둘 다 '수정'을 의미하지만, 수정하는 방식에 결정적인 차이가 있습니다.

- **PUT**: 자원 **전체를 교체(Replace)** 합니다.
- **PATCH**: 자원의 **일부만 수정(Partial Update)** 합니다.

백문이 불여일견, 예시를 통해 직접 확인해 봅시다.

#### **상황 설정**

현재 서버에 ID가 1번인 멤버의 정보가 다음과 같이 저장되어 있다고 가정해 보겠습니다.

- **`GET /members/1` 의 현재 데이터**

  ```json
  {
    "username": "harry",
    "age": 30
  }
  ```

이제 이 멤버의 `username`을 "mike"로 변경해 보겠습니다.

---

### PUT: 데이터를 통째로 교체하기 🔄

`PUT`은 **요청에 담아 보낸 데이터로 기존 데이터를 완전히 덮어씌웁니다.** 마치 기존 프로필 정보를 버리고, 새로 작성한 프로필 정보로 갈아 끼우는 것과 같습니다.

- **요청 (Request)**
  `username`만 담아서 요청을 보냅니다.

  ```http
  PUT /members/1
  Content-Type: application/json

  {
    "username": "mike"
  }
  ```

- **서버의 처리 결과 (Response)**
  서버는 ID가 1번인 멤버의 데이터를 요청받은 `{ "username": "mike" }`로 **통째로 교체**합니다. 이 과정에서 요청에 포함되지 않은 `age` 필드는 **값이 없는 상태, 즉 `null`로 변경**됩니다.

  ```json
  HTTP/1.1 200 OK
  Content-Type: application/json

  {
    "username": "mike",
    "age": null
  }
  ```

---

### PATCH: 데이터의 일부만 수정하기 📝

`PATCH`는 **요청에 담아 보낸 필드만 찾아서 해당 부분만 수정**합니다. 마치 기존 프로필 정보에서 `username` 항목에만 수정 테이프를 붙이고 새로 쓰는 것과 같습니다.

- **요청 (Request)**
  `PUT`과 동일하게 `username`만 담아서 요청을 보냅니다.

  ```http
  PATCH /members/1
  Content-Type: application/json

  {
    "username": "mike"
  }
  ```

- **서버의 처리 결과 (Response)**
  서버는 ID가 1번인 멤버의 데이터에서 `username` 필드만 "mike"로 변경합니다. 요청에 포함되지 않은 `age` 필드는 **원래 값을 그대로 유지**합니다.

  ```json
  HTTP/1.1 200 OK
  Content-Type: application/json

  {
    "username": "mike",
    "age": 30
  }
  ```

---

### ✍️ 핵심 요약

`POST`, `PUT`, `PATCH`는 기술적인 차이가 아닌 **의미론적(Semantic) 약속**에 따라 구분하여 사용해야 합니다.

- **POST**: 새로운 자원을 **생성**할 때 사용합니다.
- **PUT**: 기존 자원을 **전체 교체** 방식으로 수정할 때 사용합니다. 요청에 보내지 않은 필드는 `null`이나 기본값으로 처리될 수 있습니다.
- **PATCH**: 기존 자원의 **일부만** 수정하고 싶을 때 사용합니다. 요청에 보내지 않은 필드는 기존 값을 유지합니다.

실제 API를 설계할 때는 서비스의 요구사항에 따라 두 수정 메서드를 모두 구현하거나, 더 적합한 하나만 선택하여 구현할 수 있습니다. 중요한 것은 **각 메서드의 목적과 동작 방식을 명확히 이해하고, 일관성 있게 사용하는 것**입니다.
