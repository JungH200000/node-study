## 📜 데이터의 청사진, Prisma 모델과 필드 정의하기

Prisma의 가장 핵심적인 부분인 `schema.prisma` 파일에서 데이터베이스 **테이블**의 설계도를 직접 코드로 작성해 보겠습니다. Prisma에서는 이 설계도를 **모델(Model)** 이라고 부릅니다.

`prisma/schema.prisma` 파일을 열고, 가장 먼저 `User` 모델을 만들어 보겠습니다.

### 1. 기본 모델 구조 정의하기

`schema.prisma` 파일의 아래쪽에 다음과 같이 `User` 모델의 기본 구조를 작성합니다. 모델은 우리가 만들 테이블, 필드는 테이블의 열(column)이라고 생각하면 쉽습니다.

```prisma
// /prisma/schema.prisma

// ... (generator, datasource 블록 아래)

model User {
  id        String
  email     String
  firstName String
  lastName  String
  address   String
}
```

- **`model User { ... }`**: `User`라는 이름의 모델(테이블)을 정의합니다.
- **`id String`**: `id`라는 이름의 필드를 `String` 타입으로 정의합니다.

> **💡 Prisma 확장 프로그램 팁**
>
> 이전에 설치한 VS Code의 Prisma 확장 프로그램 덕분에, 코드를 작성하고 `Shift + Alt + F` 키를 누르면 위 코드처럼 줄이 자동으로 예쁘게 정리됩니다.

### 2. 고유 식별자(Primary Key) 설정: `@id`

코드를 작성하면 모든 필드에 빨간 밑줄이 생기며 오류가 표시될 거예요. `User` 모델 이름 위에 마우스를 올려보면 다음과 같은 메시지를 볼 수 있습니다.

> "Error validating model "User": Each model must have at least one unique criteria... Either mark a single field with `@id`, `@unique`..."

오류 메시지는 아주 친절하게도, **"모든 모델은 데이터를 고유하게 식별할 수 있는 필드가 최소 하나는 있어야 해\!"** 라고 알려주고 있습니다.

데이터베이스의 각 행(row)을 고유하게 구별해 주는 값을 **기본 키(Primary Key)** 라고 부릅니다. Prisma에서는 `@id` 속성(Attribute)을 사용해 이 필드를 지정할 수 있습니다. `id` 필드 뒤에 `@id`를 추가하면 오류가 사라집니다.

```prisma
model User {
  id        String @id
  // ...
}
```

---

### 3. 필드에 특별한 규칙 추가하기: 속성(Attributes)

Prisma 모델은 **`필드이름 필드타입 속성들`** 의 세 부분으로 구성됩니다. `@` 기호로 시작하는 **속성(Attribute)** 은 필드에 특별한 규칙이나 추가 정보를 부여하는 역할을 합니다. 이제 더 다양한 속성들을 적용하여 `User` 모델을 완성해 보겠습니다.

```prisma
// /prisma/schema.prisma

// ... (기존 코드 생략)

model User {
  // id: 기본 키, UUID로 자동 생성
  id        String   @id @default(uuid())

  // email: 중복될 수 없는 고유한 값
  email     String   @unique

  firstName String
  lastName  String
  address   String

  // createdAt: 생성 시각, 기본값으로 현재 시각 자동 입력
  createdAt DateTime @default(now())

  // updatedAt: 업데이트 시각, 변경 시마다 자동 갱신
  updatedAt DateTime @updatedAt
}
```

- **`@id`**: 이 필드가 이 테이블의 **기본 키(Primary Key)** 임을 나타냅니다.
- **`@default(uuid())`**: 데이터가 생성될 때 기본값을 설정합니다. `uuid()` 함수를 사용하면 `c1a7a2a0-3d5f-4f1a-9c4a-8e2b2a3b4c5d`와 같은 고유한 문자열 ID를 자동으로 생성해 줍니다.
  > **💡 숫자 ID vs UUID** > `id Int @id @default(autoincrement())` 처럼 1, 2, 3... 순서로 증가하는 숫자 ID를 사용할 수도 있습니다. 하지만 UUID를 사용하면 외부에서 다음 유저의 ID를 쉽게 예측할 수 없어 보안에 더 유리합니다.
- **`@unique`**: 이 필드의 값은 테이블 내에서 **항상 고유해야 함**을 의미합니다. 같은 이메일로 두 번 가입할 수 없도록 막아줍니다.
- **`@default(now())`**: 데이터 생성 시점의 **현재 시각**을 기본값으로 저장합니다. `createdAt` 필드에 주로 사용됩니다.
- **`@updatedAt`**: 데이터가 **수정될 때마다 현재 시각**으로 자동 갱신됩니다. `updatedAt` 필드에 사용됩니다.

---

### 4. 필수 필드와 선택 필드: `?` (Nullable)

Prisma 모델의 필드는 기본적으로 **필수 항목(non-nullable)** 입니다. 즉, 값을 비워둘 수 없습니다. 만약 어떤 필드를 선택 사항으로 만들고 싶다면, 타입 뒤에 `?`를 붙여주면 됩니다.

```prisma
model User {
  // ...
  address   String? // '?'를 붙이면 주소를 비워두는 것(NULL)을 허용
}
```

`address` 필드는 이제 **선택 항목(nullable)** 이 되었습니다. 이번 예제에서는 모든 필드를 필수로 사용할 것이므로 `?`는 사용하지 않겠습니다.

이제 `User` 모델 설계가 모두 끝났습니다\! 다음으로는 `Product` 모델을 만들어 보겠습니다.

---

### 📚 참고 자료

Prisma가 제공하는 더 다양한 필드 타입이 궁금하다면 공식 문서를 참고하세요.

- **Prisma Schema Field Types**: [https://www.prisma.io/docs/orm/reference/prisma-schema-reference\#model-field-scalar-types](https://www.prisma.io/docs/orm/reference/prisma-schema-reference#model-field-scalar-types)
