## ğŸŒ± ë°ì´í„°ë² ì´ìŠ¤ì— ì”¨ì•— ì‹¬ê¸°: Prisma ì‹œë”© (Seeding)

ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ê°œë°œí•˜ê³  í…ŒìŠ¤íŠ¸í•˜ë ¤ë©´ ë°ì´í„°ë² ì´ìŠ¤ì— ì–´ëŠ ì •ë„ ë°ì´í„°ê°€ ì±„ì›Œì ¸ ìˆì–´ì•¼ í¸ë¦¬í•©ë‹ˆë‹¤. ì´ë ‡ê²Œ ê°œë°œ ì´ˆê¸°ì— ë°ì´í„°ë² ì´ìŠ¤ì— **ì´ˆê¸° ë°ì´í„°ë¥¼ ë„£ëŠ” ê³¼ì •**ì„ **ì‹œë”©(Seeding)** ì´ë¼ê³  ë¶€ë¦…ë‹ˆë‹¤.

ë°ì´í„° ì–‘ì´ ë§ì„ ë•ŒëŠ” Prisma Studioë¡œ í•˜ë‚˜ì”© ì¶”ê°€í•˜ê¸°ë³´ë‹¤, ë¯¸ë¦¬ ì¤€ë¹„ëœ ë°ì´í„°ë¥¼ ìŠ¤í¬ë¦½íŠ¸ë¡œ í•œ ë²ˆì— ì‚½ì…í•˜ëŠ” ê²ƒì´ í›¨ì”¬ íš¨ìœ¨ì ì…ë‹ˆë‹¤.

### 1ë‹¨ê³„: ì‹œë“œ(Seed) ìŠ¤í¬ë¦½íŠ¸ ì¤€ë¹„í•˜ê¸°

#### 1\. mock ë°ì´í„° íŒŒì¼ ì¤€ë¹„

ë¨¼ì €, ë°ì´í„°ë² ì´ìŠ¤ì— ë„£ì„ ì´ˆê¸° ë°ì´í„°ë¥¼ ë‹´ì€ `mock.js` íŒŒì¼ì„ ì¤€ë¹„í•©ë‹ˆë‹¤. ì´ íŒŒì¼ì„ Prisma ê´€ë ¨ íŒŒì¼ë“¤ê³¼ í•¨ê»˜ ë‘ê¸° ìœ„í•´ `prisma` í´ë” ì•ˆì— `mock.js`ë¼ëŠ” ì´ë¦„ìœ¼ë¡œ ì €ì¥í•˜ê² ìŠµë‹ˆë‹¤.

```javascript
// /prisma/mock.js
export const USERS = [
  {
    id: 'b8f11e76-0a9e-4b3f-bccf-8d9b4fbf331e',
    email: 'honggd@example.com',
    firstName: 'ê¸¸ë™',
    lastName: 'í™',
    address: 'ì„œìš¸íŠ¹ë³„ì‹œ ê°•ë‚¨êµ¬ ë¬´ì‹¤ë¡œ 123ë²ˆê¸¸ 45-6',
    // createdAt, updatedAtì€ Prismaê°€ ìë™ìœ¼ë¡œ ê´€ë¦¬í•˜ë¯€ë¡œ mock ë°ì´í„°ì—ì„œëŠ” ë¹¼ë„ ì¢‹ìŠµë‹ˆë‹¤.
  },
  // ... (ë‹¤ë¥¸ ìœ ì € ë°ì´í„°)
];
```

#### 2\. ì‹œë“œ ìŠ¤í¬ë¦½íŠ¸ íŒŒì¼ ìƒì„±

Prismaì˜ ê³µì‹ ê°€ì´ë“œì— ë”°ë¼, `prisma` í´ë” ì•ˆì— `seed.js` íŒŒì¼ì„ ìƒì„±í•˜ê³  ì•„ë˜ì˜ ê¸°ë³¸ ì½”ë“œë¥¼ ì‘ì„±í•©ë‹ˆë‹¤.

```javascript
// /prisma/seed.js
import { PrismaClient } from '../generated/prisma/index.js';

const prisma = new PrismaClient();

async function main() {
  // ì—¬ê¸°ì— ì‹œë”© ë¡œì§ì„ ì‘ì„±í•©ë‹ˆë‹¤.
}

// main í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•˜ê³ , ì„±ê³µ/ì‹¤íŒ¨ ì‹œ DB ì—°ê²°ì„ ëŠë„ë¡ ë³´ì¥í•©ë‹ˆë‹¤.
main()
  .then(async () => {
    await prisma.$disconnect();
  })
  .catch(async (e) => {
    console.error(e);
    await prisma.$disconnect();
    process.exit(1);
  });
```

ì´ ì½”ë“œëŠ” Prisma ê³µì‹ ë¬¸ì„œì—ì„œ ê¶Œì¥í•˜ëŠ” ì•ˆì „í•œ ì‹¤í–‰ ë°©ì‹ìœ¼ë¡œ, `main()` í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•œ ë’¤ ì„±ê³µí•˜ë“  ì‹¤íŒ¨í•˜ë“  ë°˜ë“œì‹œ ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²°(`prisma.$disconnect()`)ì„ ì¢…ë£Œì‹œì¼œ ì¤ë‹ˆë‹¤.

---

### 2ë‹¨ê³„: ì‹œë”© ë¡œì§ êµ¬í˜„í•˜ê¸°

ì´ì œ `main()` í•¨ìˆ˜ ì•ˆì— ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì´ˆê¸°í™”í•˜ê³  mock ë°ì´í„°ë¥¼ ì‚½ì…í•˜ëŠ” ë¡œì§ì„ êµ¬í˜„í•©ë‹ˆë‹¤.

```javascript
// /prisma/seed.js
import { PrismaClient } from '../generated/prisma/index.js';
import { USERS } from './mock.js'; // ê°™ì€ í´ë”ì˜ mock.jsì—ì„œ USERSë¥¼ ê°€ì ¸ì˜´

const prisma = new PrismaClient();

async function main() {
  // 1. ê¸°ì¡´ User ë°ì´í„°ë¥¼ ëª¨ë‘ ì‚­ì œí•©ë‹ˆë‹¤.
  await prisma.user.deleteMany();
  console.log('ğŸ—‘ï¸ All users deleted.');

  // 2. mock ë°ì´í„°ë¥¼ DBì— ì‚½ì…í•©ë‹ˆë‹¤.
  await prisma.user.createMany({
    data: USERS,
    skipDuplicates: true, // idë‚˜ emailì²˜ëŸ¼ @unique í•„ë“œê°€ ì¤‘ë³µë  ê²½ìš° ë¬´ì‹œ
  });
  console.log('ğŸ“¥ Users seeded successfully.');
}

// ... (main í•¨ìˆ˜ ì‹¤í–‰ ì½”ë“œ)
```

- **`await prisma.user.deleteMany()`**: `user` í…Œì´ë¸”ì˜ ëª¨ë“  ë°ì´í„°ë¥¼ ì‚­ì œí•˜ì—¬ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ê¹¨ë—í•˜ê²Œ ë¹„ì›ë‹ˆë‹¤.
- **`await prisma.user.createMany()`**: ë°°ì—´ í˜•íƒœì˜ ë°ì´í„°ë¥¼ í•œ ë²ˆì— ì—¬ëŸ¬ ê°œ ì‚½ì…í•©ë‹ˆë‹¤.
  - `data: USERS`: `mock.js`ì—ì„œ ê°€ì ¸ì˜¨ `USERS` ë°°ì—´ì„ ì „ë‹¬í•©ë‹ˆë‹¤.
  - `skipDuplicates: true`: `id`ë‚˜ `email`ì²˜ëŸ¼ `@unique` ì†ì„±ì´ ìˆëŠ” í•„ë“œì˜ ê°’ì´ ì¤‘ë³µë˜ëŠ” ë°ì´í„°ê°€ ìˆë‹¤ë©´, ì—ëŸ¬ë¥¼ ë°œìƒì‹œí‚¤ëŠ” ëŒ€ì‹  ì¡°ìš©íˆ ê±´ë„ˆëœë‹ˆë‹¤.

> **âš ï¸ ì°¸ê³ :** `createMany()` ë©”ì†Œë“œëŠ” **SQLite** ë°ì´í„°ë² ì´ìŠ¤ì—ì„œëŠ” ì§€ì›ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

---

### 3ë‹¨ê³„: `package.json`ì— ì‹œë“œ ìŠ¤í¬ë¦½íŠ¸ ë“±ë¡í•˜ê¸°

ì´ì œ `npx prisma db seed`ë¼ëŠ” í¸ë¦¬í•œ ëª…ë ¹ì–´ë¡œ ì´ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆë„ë¡ `package.json` íŒŒì¼ì„ ì„¤ì •í•©ë‹ˆë‹¤.

`package.json` íŒŒì¼ì„ ì—´ê³ , ìµœìƒìœ„ ë ˆë²¨ì˜ scripts ì•„ë˜ì— `"prisma"` í‚¤ë¥¼ ì¶”ê°€í•´ ì£¼ì„¸ìš”.

```json
// package.json
{
  "name": "e-commerce",
  // ...
  "scripts": {
    "dev": "nodemon app.js",
    "start": "node app.js"
  },
  "prisma": {
    "seed": "node prisma/seed.js"
  }
  // ...
}
```

---

### 4ë‹¨ê³„: ì‹œë”© ì‹¤í–‰ ë° ê²°ê³¼ í™•ì¸

ì´ì œ ëª¨ë“  ì¤€ë¹„ê°€ ëë‚¬ìŠµë‹ˆë‹¤. í„°ë¯¸ë„ì— ì•„ë˜ ëª…ë ¹ì–´ë¥¼ ì…ë ¥í•˜ì—¬ ì‹œë”©ì„ ì‹¤í–‰í•©ë‹ˆë‹¤.

```bash
npx prisma db seed
```

**[í„°ë¯¸ë„ ì‹¤í–‰ ê²°ê³¼]**

```
Environment variables loaded from .env
Running seed command `node prisma/seed.js` ...
ğŸ—‘ï¸ All users deleted.
ğŸ“¥ Users seeded successfully.

The seed command has been executed.
```

ì‹œë”©ì´ ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤\! `npx prisma studio`ë¥¼ ì‹¤í–‰í•˜ì—¬ `User` ëª¨ë¸ì„ í™•ì¸í•´ ë³´ë©´, `mock.js` íŒŒì¼ì— ìˆë˜ 5ê°œì˜ ìœ ì € ë°ì´í„°ê°€ ì˜ˆì˜ê²Œ ë“¤ì–´ê°€ ìˆëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì•ìœ¼ë¡œ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì´ˆê¸° ìƒíƒœë¡œ ë˜ëŒë¦¬ê³  ì‹¶ì„ ë•Œë§ˆë‹¤ `npx prisma db seed` ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ë©´ ë©ë‹ˆë‹¤.
